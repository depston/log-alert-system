# log-alert-system
# ü§ñ –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ª–æ–≥–æ–≤ Linux —Å Telegram-–±–æ—Ç–æ–º

Telegram-–±–æ—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π –≤ –ª–æ–≥–∞—Ö Linux-—Å–µ—Ä–≤–µ—Ä–∞.

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫
```bash
git clone <repository>
cd log-alert-system
chmod +x start.sh
./start.sh
```

### 2. –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)
```bash
git clone <repository>
cd log-alert-system
cp env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ (—Å–º. –Ω–∏–∂–µ)
./docker-run.sh start
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example`:

```
BOT_TOKEN=your_bot_token_here
CHAT_ID=your_chat_id_here
LOGGER_MODE=normal  # normal | verbose | silent
LOG_FILES=/var/log/auth.log /var/log/syslog /var/log/kern.log
CHECK_INTERVAL=30
TZ=Europe/Moscow
COMPOSE_PROJECT_NAME=log-alert-system
```

- `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞
- `CHAT_ID` ‚Äî –≤–∞—à chat_id –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `LOGGER_MODE` ‚Äî —Ä–µ–∂–∏–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: normal (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), verbose (–≤—Å–µ —Å–æ–±—ã—Ç–∏—è), silent (–±–µ–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
- `LOG_FILES` ‚Äî —Å–ø–∏—Å–æ–∫ –ª–æ–≥-—Ñ–∞–π–ª–æ–≤ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- `CHECK_INTERVAL` ‚Äî –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–æ–≤ (—Å–µ–∫)

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram
1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather
2. –ü–æ–ª—É—á–∏—Ç–µ Chat ID —á–µ—Ä–µ–∑ @userinfobot
3. –í–ø–∏—à–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ `.env`

### 5. –ó–∞–ø—É—Å–∫
```bash
# Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
./docker-run.sh start

# –ò–ª–∏ systemd (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
sudo chmod +x install.sh
sudo ./install.sh
sudo systemctl start log-bot.service log-watcher.service
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `start.sh` ‚Äî –±—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã
- `docker-run.sh` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ (start, stop, status, logs, test –∏ –¥—Ä.)
- `config/bot_control.sh` ‚Äî Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–≥–µ—Ä–æ–º
- `config/log_watcher.sh` ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤ Telegram
- `scripts/settings.conf` ‚Äî –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–≥–µ—Ä–∞
- `env.example` ‚Äî –ø—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `test/generate_test_logs.sh` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –ª–æ–≥–æ–≤
- `nginx.conf` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üì± –ö–æ–º–∞–Ω–¥—ã Telegram-–±–æ—Ç–∞

| –ö–æ–º–∞–Ω–¥–∞         | –û–ø–∏—Å–∞–Ω–∏–µ                  |
|----------------|---------------------------|
| `/start`       | –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É              |
| `/status`      | –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã             |
| `/mode_normal` | –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º              |
| `/mode_verbose`| –ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–µ–∂–∏–º            |
| `/mode_silent` | –û—Ç–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è      |

---

## üîß –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

- **Normal**: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **Verbose**: –≤—Å–µ —Å–æ–±—ã—Ç–∏—è —Å–∏—Å—Ç–µ–º—ã
- **Silent**: —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω—ã

---

## üê≥ Docker-–∫–æ–º–∞–Ω–¥—ã

```bash
./docker-run.sh start      # –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
./docker-run.sh stop       # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
./docker-run.sh status     # –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
./docker-run.sh logs       # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
./docker-run.sh test       # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
./docker-run.sh dev --web  # –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
./docker-run.sh test
```

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
./config/bot_control.sh test
./config/log_watcher.sh test
./test/generate_test_logs.sh create
```

- –°–∫—Ä–∏–ø—Ç `generate_test_logs.sh` —Å–æ–∑–¥–∞—ë—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –ª–æ–≥–∏ –≤ `/tmp/test_logs`.
- –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ Docker –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é.

---

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

- **–ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π**: `dos2unix scripts/settings.conf`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**: `./config/bot_control.sh test`
- **–õ–æ–≥–∏ Docker**: `docker logs log-alert-bot`
- **–ü—Ä–∞–≤–∞ –Ω–∞ —Å–∫—Ä–∏–ø—Ç—ã**: `chmod +x *.sh config/*.sh scripts/*.sh`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã `curl`, `jq`, `docker`, `docker-compose`

---

## ‚ÑπÔ∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –î–ª—è —Ä–∞–±–æ—Ç—ã –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è nginx (–ø–æ—Ä—Ç 8080 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).
- –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π –∑–∞–¥–∞—é—Ç—Å—è –≤ `scripts/settings.conf` –∏–ª–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
- –î–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å Grafana –∏ Redis (—Å–º. –æ–ø—Ü–∏–∏ docker-run.sh).

---

## ‚ùó –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è

| –û—à–∏–±–∫–∞/–°–∏–º–ø—Ç–æ–º                | –ü—Ä–∏—á–∏–Ω–∞/–û–ø–∏—Å–∞–Ω–∏–µ                                      | –†–µ—à–µ–Ω–∏–µ                                   |
|-------------------------------|------------------------------------------------------|--------------------------------------------|
| `‚ùå Docker –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω`      | Docker –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ                           | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker –∏ Docker Compose         |
| `‚ùå –§–∞–π–ª .env –Ω–µ –Ω–∞–π–¥–µ–Ω!`      | –ù–µ —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è               | –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ |
| `‚ùå BOT_TOKEN –Ω–µ –∑–∞–¥–∞–Ω`        | –ù–µ —É–∫–∞–∑–∞–Ω —Ç–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞                        | –£–∫–∞–∂–∏—Ç–µ BOT_TOKEN –≤ `.env`                 |
| `‚ùå CHAT_ID –Ω–µ –∑–∞–¥–∞–Ω`          | –ù–µ —É–∫–∞–∑–∞–Ω chat_id                                    | –£–∫–∞–∂–∏—Ç–µ CHAT_ID –≤ `.env`                   |
| `permission denied` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ| –ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤                      | –í—ã–ø–æ–ª–Ω–∏—Ç–µ: `chmod +x *.sh config/*.sh scripts/*.sh` |
| `curl: command not found`      | –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω curl                                   | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: `sudo apt-get install curl`    |
| `jq: command not found`        | –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω jq                                     | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: `sudo apt-get install jq`      |
| `docker: command not found`    | –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Docker                                 | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker                         |
| `Cannot connect to the Docker daemon` | Docker –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤ | –ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker: `sudo systemctl start docker` –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É |
| `Error: EACCES: permission denied` | –ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –ª–æ–≥–∞–º –∏–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º | –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å sudo –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ |
| –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –≤ Telegram     | –ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω –∏–ª–∏ chat_id, –ª–∏–±–æ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ `.env` –∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ |
| –ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Å–æ–±—ã—Ç–∏—è—Ö     | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π LOGGER_MODE –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã —Å–æ–±—ã—Ç–∏–π         | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `.env` –∏ `settings.conf` |
| –õ–æ–≥–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è            | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—É—Ç–∏ –∫ –ª–æ–≥–∞–º –∏–ª–∏ –Ω–µ—Ç –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π      | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é LOG_FILES –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ |
| –û—à–∏–±–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏               | Windows-—Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–æ–≤                                | –í—ã–ø–æ–ª–Ω–∏—Ç–µ: `dos2unix scripts/settings.conf` |
| `Address already in use`       | –ü–æ—Ä—Ç —É–∂–µ –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º                      | –û—Å–≤–æ–±–æ–¥–∏—Ç–µ –ø–æ—Ä—Ç –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏      |

---
